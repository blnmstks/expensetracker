# Визуальная диаграмма архитектуры приложения

## 🏗️ Структура компонентов

```
┌─────────────────────────────────────────────────────────────┐
│                         App.tsx                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │          State Management                           │   │
│  │  • expenses, currencySettings                      │   │
│  │  • isAuthenticated                                 │   │
│  │  • addExpense, deleteExpense, handleLogout         │   │
│  └─────────────────────────────────────────────────────┘   │
│                           ↓                                  │
│  ┌─────────────────────────────────────────────────────┐   │
│  │       ConfigProvider (Ant Design)                  │   │
│  │       • Локализация (ruRU)                         │   │
│  │       • Тема (зеленый цвет)                        │   │
│  └─────────────────────────────────────────────────────┘   │
│                           ↓                                  │
│  ┌─────────────────────────────────────────────────────┐   │
│  │            RouterProvider                           │   │
│  │         createAppRouter(props)                      │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│                 src/routes/index.tsx                        │
│  ┌─────────────────────────────────────────────────────┐   │
│  │              Route Configuration                    │   │
│  │                                                      │   │
│  │  /              → Navigate to /expenses            │   │
│  │  /expenses      → ExpensesPage                     │   │
│  │  /analytics     → AnalyticsPage                    │   │
│  │  /history       → HistoryPage                      │   │
│  │  /settings      → SettingsPage                     │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│          src/components/layout/MainLayout.tsx               │
│  ┌─────────────────────────────────────────────────────┐   │
│  │         Layout Structure                            │   │
│  │                                                      │   │
│  │  Desktop (≥768px):                                 │   │
│  │  ┌────────┬──────────────────────────────────┐    │   │
│  │  │        │                                   │    │   │
│  │  │ Sider  │        <Outlet />                │    │   │
│  │  │        │                                   │    │   │
│  │  └────────┴──────────────────────────────────┘    │   │
│  │                                                      │   │
│  │  Mobile (<768px):                                  │   │
│  │  ┌──────────────────────────────────────────┐    │   │
│  │  │           Header                         │    │   │
│  │  ├──────────────────────────────────────────┤    │   │
│  │  │                                          │    │   │
│  │  │          <Outlet />                     │    │   │
│  │  │                                          │    │   │
│  │  ├──────────────────────────────────────────┤    │   │
│  │  │      Bottom Navigation Bar               │    │   │
│  │  └──────────────────────────────────────────┘    │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│                     src/pages/                              │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐     │
│  │  Expenses    │  │  Analytics   │  │   History    │     │
│  │    Page      │  │     Page     │  │     Page     │     │
│  └──────────────┘  └──────────────┘  └──────────────┘     │
│         ↓                  ↓                  ↓              │
│  ┌──────────────────────────────────────────────────┐      │
│  │          ErrorBoundary Wrapper                   │      │
│  └──────────────────────────────────────────────────┘      │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│                   src/components/                           │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐     │
│  │ AddExpense   │  │  Analytics   │  │   History    │     │
│  │  Component   │  │  Component   │  │  Component   │     │
│  └──────────────┘  └──────────────┘  └──────────────┘     │
│         ↓                  ↓                  ↓              │
│  ┌──────────────────────────────────────────────────┐      │
│  │         Forms, Tables, Charts                    │      │
│  │         UI Components (Ant Design)               │      │
│  └──────────────────────────────────────────────────┘      │
└─────────────────────────────────────────────────────────────┘
```

## 🔄 Поток навигации

```
User clicks menu item
        ↓
handleMenuClick / handleNavClick
        ↓
navigate('/route-name')
        ↓
React Router updates URL
        ↓
<Outlet /> renders new Page component
        ↓
MainLayout stays mounted (navbar visible)
```

## 📊 Поток данных

```
                    App.tsx
                      ↓
          ┌───────────┴───────────┐
          ↓                       ↓
    State (expenses,        Handlers
    currencySettings)       (addExpense, etc)
          ↓                       ↓
          └───────────┬───────────┘
                      ↓
              createAppRouter
                      ↓
          ┌───────────┴───────────┐
          ↓           ↓           ↓
    ExpensesPage  AnalyticsPage  etc...
          ↓           ↓           ↓
    AddExpense   Analytics     History
     Component    Component   Component
```

## 🎯 Навигация между страницами

```
Desktop:                           Mobile:
┌──────────────┐                  ┌──────────────┐
│   Sidebar    │                  │    Header    │
│              │                  ├──────────────┤
│ • Расходы    │ ← Click         │              │
│ • Аналитика  │                  │   Content    │
│ • История    │                  │              │
│ • Настройки  │                  ├──────────────┤
│              │                  │ Bottom Nav   │
│  [Выйти]     │                  │ • • • •      │
└──────────────┘                  └──────────────┘
                                         ↑
                                       Click
```

## 🔐 Защита роутов (текущая реализация)

```
User opens app
        ↓
Check localStorage for auth_token
        ↓
   ┌────┴────┐
   ↓         ↓
 Yes        No
   ↓         ↓
Router    Login Page
```

## 📦 Модульность

```
├── App.tsx              # Глобальное состояние
├── routes/              # Конфигурация роутов
│   └── index.tsx
├── pages/               # Страницы (обертки)
│   ├── ExpensesPage
│   ├── AnalyticsPage
│   └── ...
├── components/          # Бизнес-логика
│   ├── AddExpense
│   ├── Analytics
│   └── ...
└── services/           # API вызовы
    └── api.ts
```

Каждый уровень имеет свою ответственность:
- **App**: Управление глобальным состоянием
- **Routes**: Определение маршрутов
- **Pages**: Обертки с ErrorBoundary
- **Components**: Бизнес-логика и UI
- **Services**: Работа с API
